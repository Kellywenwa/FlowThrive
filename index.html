<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Mobile App Meta -->
<meta name="format-detection" content="telephone=no">
<meta name="msapplication-tap-highlight" content="no">
<meta name="theme-color" content="#ff6b9d">

<!-- iOS Home Screen -->
<link rel="apple-touch-icon" href="/icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Android -->
<link rel="manifest" href="/manifest.json">
  <title>FlowThrive âœ¨ Empower Your Cycle</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js">
  <style>
    /* CSS: Styles everything! Customize colors/fonts here. */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Poppins', sans-serif; 
      background: linear-gradient(135deg, #f9d1d4 0%, #e8c9e8 50%, #b8d8f0 100%); 
      min-height: 100vh; 
      color: #333; 
    }
    nav { 
      background: rgba(255,255,255,0.9); 
      padding: 1rem; 
      display: flex; 
      justify-content: center; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
    }
    nav button { 
      background: #ff9ff3; 
      border: none; 
      padding: 0.8rem 1.5rem; 
      margin: 0 0.5rem; 
      border-radius: 25px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: all 0.3s; 
    }
    nav button.active, nav button:hover { 
      background: #ff6b9d; 
      transform: scale(1.05); 
    }
    section { 
      display: none; 
      max-width: 800px; 
      margin: 2rem auto; 
      padding: 2rem; 
      background: white; 
      border-radius: 20px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
    }
    section.active { display: block; }
    h1 { color: #ff6b9d; text-align: center; margin-bottom: 1rem; }
    h2 { color: #ff9ff3; margin: 1.5rem 0 1rem; }
    .card { background: #f8f9ff; padding: 1.5rem; border-radius: 15px; margin: 1rem 0; }
    .accordion { 
      background: #e8f4fd; 
      cursor: pointer; 
      padding: 1rem; 
      border-radius: 10px; 
      margin: 0.5rem 0; 
      transition: 0.3s; 
    }
    .accordion:hover { background: #d1e8ff; }
    .panel { display: none; padding: 1rem; background: white; border-radius: 10px; }
    input, select, button { 
      padding: 0.8rem; 
      border: 2px solid #ff9ff3; 
      border-radius: 10px; 
      font-size: 1rem; 
    }
    button { background: #ff9ff3; color: white; cursor: pointer; transition: 0.3s; }
    button:hover { background: #ff6b9d; }
    #chart { max-height: 300px; }
    .badge { background: gold; padding: 0.5rem 1rem; border-radius: 20px; font-weight: bold; display: inline-block; }
    .tip { font-size: 1.2rem; text-align: center; padding: 2rem; background: linear-gradient(45deg, #ffecd2, #fcb69f); border-radius: 20px; }
    /* Cartoon character! Customize face. */
    .character { text-align: center; font-size: 4rem; margin: 1rem; }
  </style>
</head>
<body>
  <!-- HTML Structure: Like rooms in a house. -->
  <nav>
    <button onclick="showSection('home')" class="active">ğŸ  Home</button>
    <button onclick="showSection('education')">ğŸ“š Education</button>
    <button onclick="showSection('tracker')">ğŸ“… Tracker</button>
   <button onclick="showSection('tips')">Tips</button>
<button onclick="showSection('ask')">Ask Anything</button>
  </nav>
  <!-- === NEW: ASK ANYTHING Q&A PAGE === -->
  <section id="ask">
    <h1>Ask Anything (100% Anonymous!)</h1>
    <div class="character">Privacy mode ON</div>
    
    <div class="card">
      <p><strong>No name. No judgment. Just answers.</strong> Ask about periods, bodies, feelings â€” anything!</p>
      <textarea id="questionInput" placeholder="Type your question here..." style="width:100%;height:120px;padding:1rem;border:2px solid #ff9ff3;border-radius:15px;font-size:1rem;margin:1rem 0;"></textarea>
      <button onclick="submitQuestion()" style="background:#ff6b9d;color:white;padding:0.8rem 1.5rem;border:none;border-radius:15px;font-weight:600;cursor:pointer;">
        Submit Question
      </button><br><br>
<button onclick="toggleReminders()" id="reminderBtn" style="background:#4ecdc4;color:white;padding:0.8rem 1.5rem;border:none;border-radius:15px;font-weight:600;cursor:pointer;font-size:1rem;">ğŸ”” **Turn ON Reminders**</button>
<p id="reminderStatus" style="color:#999;text-align:center;margin-top:0.5rem;">**OFF** â€“ Daily logs + "Period tomorrow!" magic! âœ¨</p>
    </div>

    <div id="qaList" style="margin-top:2rem;"></div>
  </section>
  <!-- === END Q&A PAGE === -->
  <!-- Home Section -->
  <section id="home" class="active">
    <h1>ğŸŒ¸ Welcome to FlowThrive! ğŸŒ¸</h1>
    <div class="character">ğŸ˜ŠğŸ‘‹</div>
    <div class="card">
      <p><strong>Your cycle is <em>powerful</em>â€”not a secret!</strong> Learn, track, thrive. Science-based, stigma-free, for <strong>everyone who menstruates</strong>.</p>
    </div>
    <div class="card">
          <div class="card">
      <h2>Quick Features</h2>
      <ul>
        <li>Interactive lessons</li>
        <li>Predict your next period</li>
        <li>Daily self-care tips</li>
        <li>Earn badges!</li>
      </ul>
    </div>

    <!-- BADGE SHOWCASE -->
    <div class="card">
      <h2>Your Badges</h2>
      <div id="badgeShowcase" style="display:flex;flex-wrap:wrap;gap:0.8rem;justify-content:center;margin-top:1rem;"></div>
      <div style="margin-top:1rem;text-align:center;">
        <div style="background:#eee;height:12px;border-radius:6px;overflow:hidden;">
          <div id="badgeProgress" style="background:#ff6b9d;height:100%;width:0%;transition:width 0.5s;"></div>
        </div>
        <small id="badgeCount">0 / 5 badges earned</small>
      </div>
    </div>
  </section>

  <!-- Education Section -->
  <section id="education">
    <h1>ğŸ“š Cycle Education Hub</h1>
    <div class="card">
      <h2>ğŸ”¬ Your Cycle Explained (28-day average)</h2>
      <div class="accordion" onclick="togglePanel(this)">Menstrual Phase (Days 1-5) ğŸ‘‰</div>
      <div class="panel"><p>Bleeding time! Uterus sheds lining. <strong>Tip:</strong> Rest, heat pads, iron-rich foods. <em>Normal!</em></p></div>
      
      <div class="accordion" onclick="togglePanel(this)">Follicular (Days 6-14) ğŸ‘‰</div>
      <div class="panel"><p>Energy rises! Egg matures. <strong>Tip:</strong> Exercise, fresh foods.</p></div>
      
      <div class="accordion" onclick="togglePanel(this)">Ovulation (Day 14) ğŸ‘‰</div>
      <div class="panel"><p>Egg releases. Fertile window! Some feel twinges.</p></div>
      
      <div class="accordion" onclick="togglePanel(this)">Luteal (Days 15-28) ğŸ‘‰</div>
      <div class="panel"><p>PMS possible. Progesterone peaks. <strong>Tip:</strong> Magnesium, sleep.</p></div>
    </div>
    <div class="card">
      <h2>ğŸ›‘ Myths Busted</h2>
      <div class="accordion" onclick="togglePanel(this)">"Periods sync with friends" âŒ</div>
      <div class="panel"><p>No science! Just coincidence.</p></div>
      <div class="accordion" onclick="togglePanel(this)">"You can't swim/exercise" âŒ</div>
      <div class="panel"><p>Totally canâ€”with the right products!</p></div>
    </div>
    <div class="card">
      <h2>ğŸš¨ When to See a Doctor</h2>
      <ul>
        <li>Bleeding soaks pad/tampon in 1 hour</li>
        <li>Pain stops you from school/work</li>
        <li>No period for 3+ months (not pregnant)</li>
      </ul>
    </div>
  </section>

  <!-- Tracker Section -->
  <section id="tracker">
    <h1>ğŸ“… Your Cycle Tracker</h1>
    <div class="card">
      <label>Last Period Start:</label><br>
      <input type="date" id="lastStart" onchange="saveData()">
      <br><br>
      <label>Avg Cycle Length (days):</label><br>
      <input type="number" id="avgLength" value="28" min="21" max="35" onchange="saveData()">
      <br><br>
      <button onclick="logToday()">Log Today's Mood & Flow ğŸ¯</button>
    </div>
    <div id="prediction" class="tip">Enter dates to predict! ğŸ”®</div>
    <canvas id="chart"></canvas>
    <div id="logs"></div>
    <div id="badge"></div>
  </section>

  <!-- Tips Section -->
  <section id="tips">
    <h1>ğŸ’¡ Your Daily Tips</h1>
    <div id="dailyTip" class="tip">
      Log your cycle in Tracker for personalized tips! ğŸŒŸ
    </div>
  </section>

     // === Q&A SYSTEM ===
    function submitQuestion() {
      const input = document.getElementById('questionInput');
      const question = input.value.trim();
      if (!question) {
        alert('Please write a question!');
        return;
      }

      // Load existing Q&A
      let qa = JSON.parse(localStorage.getItem('flowthriveQA')) || [];

      // Add new question
      qa.unshift({
        q: question,
        a: null, // No answer yet
        timestamp: new Date().toISOString()
      });

      // Save & update
      localStorage.setItem('flowthriveQA', JSON.stringify(qa));
      input.value = '';
      loadQA();
      alert('Question submitted! Weâ€™ll answer soon.');
    }

    function loadQA() {
      const qa = JSON.parse(localStorage.getItem('flowthriveQA')) || [];
      const container = document.getElementById('qaList');
      
      if (qa.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#999;"><em>No questions yet. Be the first!</em></p>';
        return;
      }

      container.innerHTML = qa.map(item => `
        <div class="card" style="margin:1rem 0;background:#f8f9ff;">
          <p><strong>Q:</strong> ${escapeHTML(item.q)}</p>
          ${item.a 
            ? `<p style="margin-top:0.8rem;color:#ff6b9d;"><strong>A:</strong> ${escapeHTML(item.a)}</p>` 
            : `<p style="color:#999;font-style:italic;">Answer coming soon...</p>`
          }
          <small style="color:#aaa;">${formatDate(item.timestamp)}</small>
        </div>
      `).join('');
    }

    // Helper: Prevent XSS
    function escapeHTML(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // Helper: Pretty date
    function formatDate(iso) {
      const date = new Date(iso);
      const now = new Date();
      const diff = now - date;
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      if (days === 0) return 'Today';
      if (days === 1) return 'Yesterday';
      return `${days} days ago`;
    }

    // Auto-load Q&A when tab opens
    const originalShowSection = showSection;
    showSection = function(id) {
      originalShowSection(id);
      if (id === 'ask') loadQA();
    };
    // === END Q&A ===     // === BADGE SYSTEM ===
    const BADGES = [
      { id: 'first_log', name: 'First Log', icon: 'First Step', desc: 'Log your first day!' },
      { id: 'myth_buster', name: 'Myth Buster', icon: 'Myth Smasher', desc: 'Read all myths in Education' },
      { id: 'streak_7', name: '7-Day Streak', icon: 'Consistency Star', desc: 'Log 7 days in a row' },
      { id: 'period_pro', name: 'Period Pro', icon: 'Cycle Expert', desc: 'Log 3 full cycles' },
      { id: 'question_asker', name: 'Curious Mind', icon: 'Question Hero', desc: 'Ask a question' }
    ];

    function initBadges() {
      data.badges = data.badges || [];
      data.mythViews = data.mythViews || 0;
      data.cycleCount = data.cycleCount || 0;
      updateBadgeUI();
    }

    function unlockBadge(id) {
      if (data.badges.includes(id)) return;
      data.badges.push(id);
      saveData();
      triggerConfetti();
      updateBadgeUI();
      alert(`Badge Unlocked: ${BADGES.find(b => b.id === id).name}!`);
    }

    function triggerConfetti() {
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
      });
    }

    function updateBadgeUI() {
      const showcase = document.getElementById('badgeShowcase');
      const progress = document.getElementById('badgeProgress');
      const count = document.getElementById('badgeCount');

      if (!showcase) return;

      showcase.innerHTML = BADGES.map(badge => {
        const earned = data.badges.includes(badge.id);
        return `
          <div style="text-align:center;">
            <div style="font-size:2.5rem;${!earned && 'filter:grayscale(100%);opacity:0.5;'}">
              ${badge.icon}
            </div>
            <div style="font-size:0.8rem;font-weight:600;margin-top:0.3rem;">
              ${earned ? badge.name : '???'}
            </div>
          </div>
        `;
      }).join('');

      const earned = data.badges.length;
      progress.style.width = `${(earned / 5) * 100}%`;
      count.textContent = `${earned} / 5 badges earned`;
    }

    // Hook into existing functions
    const originalLogToday = logToday;
    logToday = function() {
      originalLogToday();
      unlockBadge('first_log');
      if (data.streak >= 7) unlockBadge('streak_7');
    };

    const originalSubmitQuestion = submitQuestion;
    submitQuestion = function() {
      originalSubmitQuestion();
      unlockBadge('question_asker');
    };

    // Myth busting: count accordion opens
    document.querySelectorAll('.accordion').forEach(acc => {
      const originalClick = acc.onclick;
      acc.onclick = function() {
        if (originalClick) originalClick();
        if (this.textContent.includes('Myths')) {
          data.mythViews = (data.mythViews || 0) + 1;
          if (data.mythViews >= 2) unlockBadge('myth_buster');
        }
      };
    });

    // Period Pro: detect new cycle
    const originalSaveData = saveData;
    saveData = function() {
      originalSaveData();
      const today = new Date();
      const last = new Date(data.lastStart);
      const daysSince = Math.floor((today - last) / (24*60*60*1000));
      if (daysSince >= 28 && !data.lastCycleCheck) {
        data.cycleCount = (data.cycleCount || 0) + 1;
        data.lastCycleCheck = true;
        if (data.cycleCount >= 3) unlockBadge('period_pro');
      }
      if (daysSince < 5) data.lastCycleCheck = false; // Reset on new period
    };

    // Auto-init
    initBadges();
    // === END BADGE SYSTEM ===<script>let remindersOn = localStorage.getItem('remindersOn') === 'true';

function toggleReminders() {
  if (remindersOn) {
    localStorage.setItem('remindersOn', 'false');
    document.getElementById('reminderBtn').innerHTML = 'ğŸ”” Reminders **OFF**';
    alert('Reminders paused! ğŸ˜´');
  } else {
    if ('Notification' in window) {
      Notification.requestPermission().then(() => {
        localStorage.setItem('remindersOn', 'true');
        document.getElementById('reminderBtn').innerHTML = 'ğŸ”” Reminders **ON**';
        checkAndNotify();  // Test now!
        alert('Daily reminders **ON**! Check 8 PM ğŸŒ™');
      });
    }
  }
}

function checkAndNotify() {
  if (!remindersOn || Notification.permission !== 'granted') return;
  
  const now = new Date();
  const hour = now.getHours();
  
  // 8 PM daily
  if (hour === 20) {
    new Notification('FlowThrive ğŸŒ¸', {
      body: 'Log your mood/flow? Takes 10 secs!',
      icon: '/icon-192.png',
      badge: '/icon-192.png'
    });
  }
  
  // Period tomorrow?
  if (data.lastStart) {
    const nextPeriod = new Date(new Date(data.lastStart).getTime() + data.avgLength * 86400000);
    const daysLeft = Math.ceil((nextPeriod - now) / 86400000);
    if (daysLeft <= 3 && daysLeft > 0) {
      new Notification('Period Alert! âš ï¸', { body: `In ${daysLeft} days â€“ you got this! ğŸ’ª` });
    }
  }
}

// Check every hour (PWA limit)
setInterval(checkAndNotify, 3600000);  // 1 hour
    /* JS: Makes it interactive! Read like a story. */
    let data = JSON.parse(localStorage.getItem('flowData')) || { lastStart: '', avgLength: 28, logs: [], streak: 0 };

    // Show/hide sections
    function showSection(id) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
      if (id === 'tracker') updateTracker();
      if (id === 'tips') updateTips();
    }

    // Toggle education panels
    function togglePanel(el) {
      el.nextElementSibling.style.display = el.nextElementSibling.style.display === 'block' ? 'none' : 'block';
    }

    // Save data to browser
    function saveData() {
      data.lastStart = document.getElementById('lastStart').value;
      data.avgLength = parseInt(document.getElementById('avgLength').value);
      localStorage.setItem('flowData', JSON.stringify(data));
      updateTracker();
    }

    // Predict & update
    function updateTracker() {
      if (!data.lastStart) return;
      const today = new Date();
      const last = new Date(data.lastStart);
      const next = new Date(last.getTime() + data.avgLength * 24 * 60 * 60 * 1000);
      document.getElementById('prediction').innerHTML = `Next period: <strong>${next.toDateString()}</strong> (${Math.ceil((next - today) / (24*60*60*1000))} days) âœ¨`;

      // Simple chart (mood over days)
      const ctx = document.getElementById('chart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.logs.slice(-7).map(l => l.date.slice(5)),
          datasets: [{ label: 'Energy (1-5)', data: data.logs.slice(-7).map(l => l.energy || 3), borderColor: '#ff9ff3' }]
        }
      });

      // Show logs
      document.getElementById('logs').innerHTML = data.logs.slice(-5).map(l => `<div class="card"><strong>${l.date}</strong>: ${l.flow} | Mood: ${l.mood} | Energy: ${l.energy}/5</div>`).join('');

      // Badge for streak
      document.getElementById('badge').innerHTML = data.streak >= 3 ? '<span class="badge">ğŸ… Streak Master! Keep going!</span>' : '';
    }

    // Log today
    function logToday() {
      const today = new Date().toISOString().slice(0,10);
      if (data.logs.some(l => l.date === today)) return alert('Already logged today! ğŸ˜Š');
      const flow = prompt('Flow: light/med/heavy/none') || 'none';
      const mood = prompt('Mood: happy/sad/okay') || 'okay';
      const energy = prompt('Energy (1-5):') || 3;
      data.logs.push({date: today, flow, mood, energy: parseInt(energy)});
      data.streak++;
      saveData();
      updateTracker();
    }

    // Daily tip based on phase
    function updateTips() {
      if (!data.lastStart) return;
      const today = new Date();
      const last = new Date(data.lastStart);
      const daysSince = Math.floor((today - last) / (24*60*60*1000)) % data.avgLength;
      let tip;
      if (daysSince <= 5) tip = 'ğŸ« Menstrual: Chocolate, heat pad, gentle walks. You got this!';
      else if (daysSince <= 14) tip = 'ğŸ’ƒ Follicular: High energyâ€”dance, eat greens!';
      else if (daysSince <= 16) tip = 'ğŸŒ¸ Ovulation: Fertile vibes. Hydrate!';
      else tip = 'ğŸ›€ Luteal: PMS? Magnesium, bubble bath, breathe.';
      document.getElementById('dailyTip').innerHTML = tip;
    }

    // Load on start
       // Load saved values
    document.getElementById('lastStart').value = data.lastStart;
    document.getElementById('avgLength').value = data.avgLength;

    // AUTO-UPDATE TRACKER WHEN PAGE LOADS
    if (document.getElementById('tracker').classList.contains('active')) {
      updateTracker();
    }
 // ğŸ”” REMINDERS (PWA - Paste & Done!)
let remindersOn = localStorage.getItem('remindersOn') === 'true';

function toggleReminders() {
  remindersOn = !remindersOn;
  localStorage.setItem('remindersOn', remindersOn);
  
  const btn = document.getElementById('reminderBtn');
  const status = document.getElementById('reminderStatus');
  
  if (remindersOn) {
    if ('Notification' in window && Notification.permission !== 'granted') {
      Notification.requestPermission().then(perm => {
        if (perm === 'granted') {
          btn.innerHTML = 'ğŸ”” **Reminders ON**';
          status.innerHTML = '<span style="color:green;">**ACTIVE!** Check every hour ğŸŒ™</span>';
          checkAndNotify();  // Test NOW!
          alert('âœ… **DAILY REMINDERS ON!** Open at 8 PM to test! ğŸ’¥');
        } else {
          alert('Allow notifications in browser! ğŸ“±âš™ï¸');
          remindersOn = false;
        }
      });
    } else {
      btn.innerHTML = 'ğŸ”” **Reminders ON**';
      status.innerHTML = '<span style="color:green;">**ACTIVE!**</span>';
      checkAndNotify();
    }
  } else {
    btn.innerHTML = 'ğŸ”” **Turn ON Reminders**';
    status.innerHTML = '**OFF** â€“ Click to enable! âœ¨';
    alert('ğŸ˜´ Reminders paused.');
  }
}

function checkAndNotify() {
  if (!remindersOn || !('Notification' in window) || Notification.permission !== 'granted') return;
  
  const now = new Date();
  const hour = now.getHours();
  
  // ğŸŒ™ 8 PM DAILY LOG REMINDER
  if (hour === 20) {  // Change to now.getHours() for **INSTANT TEST**
    new Notification('ğŸŒ¸ FlowThrive â€“ Log Today!', {
      body: 'Mood + flow? **2 secs** â†’ Better predictions! ğŸ’•',
      icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23ff6b9d"/><text x="50" y="55" text-anchor="middle" fill="white" font-size="20">ğŸŒ¸</text></svg>',
      badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50"><circle cx="25" cy="25" r="20" fill="%23ff6b9d"/></svg>'
    });
  }
  
  // âš ï¸ PERIOD ALERTS (3/2/1 days)
  if (data.lastStart && data.avgLength) {
    const last = new Date(data.lastStart);
    const nextPeriod = new Date(last.getTime() + data.avgLength * 86400000);
    const daysLeft = Math.ceil((nextPeriod - now) / 86400000);
    
    if (daysLeft <= 3 && daysLeft > 0) {
      new Notification('ğŸš¨ Period Incoming!', {
        body: `**${daysLeft} day${daysLeft>1?'s':''}!** Stock pads? You got this ğŸ’ª`,
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23ff1493"/><text x="50" y="55" text-anchor="middle" fill="white" font-size="20">âš ï¸</text></svg>'
      });
    }
  }
}

// ğŸ”¥ CHECK EVERY HOUR (PWA smart!)
setInterval(checkAndNotify, 3600000);  // 60 mins

// Auto-check on Tracker open
if (document.getElementById('tracker')) checkAndNotify(); </script>
</body>
</html>
